- need doc
- need re-upstream
- test common encryption code
- rewritte the variant code for dash, using memory ?
